# worm19
This repository has been created for my Master's dissertation in Bioinformatics. It contains all the tools that have been used for the analysis of the regulatory dopaminergic signature of *C. elegans*.

Some of the scripts are intended to be used individually, because they expect separately downloaded data from ENCODE (the ChIP-seq scripts) or they download their own data (the Single Cell script). The main script used in this Master's dissertation is **w19_complete_pipeline.R**, and it contains the whole pipeline of scripts that have been used for the search of regulatory windows and the posterior analysis of the data. This script relies on data, such as the PWM or the reference sequences, that can be found into the **data** folder.

A brief description of the scripts is provided here:
- The folder **data** contains another folder (named **original_PWMs**) with the PWMs of the DNA-binding motifs of the selected transcription factors; a folder (named **reference**) with the information of the DNA sequences in which we search the motifs. Additionaly, a template with the information of the genes in all *Caenorhabditis* species on which we annotate the results and the selected neuronal types is provided.
- The folder **w18** contains the R package for the search of the DNA-binding motifs of the selected transcription factors in a set of sequences. Inside you can found a script named **make_w18_package.R** with instructions on how to install it.
- The file **Analysis_Single_Cell_Cao.R** uses the data from Cao et al. (2017) to get a list of DEG in dopaminergic neurons. It also gets lists of DEG in other neuronal types: ASE, GABAergic, RIA, SDQ/ALN/PLN and Touch receptor neurons. These gene lists are intended to be use as a control when looking for the dopaminergic signature.
- The file **ChIP-seq_comparison.R** works with BED files downloaded from ENCODE, and loads them from the computer directly before analysing them.
- The file **Split_multiFASTA_into_chromosomes.py** is used to split the .fna (multiFASTA) file of the WBcel235 genome version into individual FASTA files, each of them corresponding to a chromosome.
- The file **Get_peak_sequences_from_BED.py** uses a given BED file and the genome FASTA files (split into chromosomes from the previous script) as an input; and writes a FASTA file with the sequences corresponding to the peaks of the BED file.
- The file **w19_complete_pipeline.R** contains the whole pipeline of scripts that have been used for the search of regulatory windows and the posterior analysis of the data, and can be divided in those individual scripts easily. First, it uses the sequences and the PWMs to search for windows of a given size in the DNA-sequences. We can specify the number of minimum different motifs that a window needs to have. It also offers the posibility of combining close windows into a bigger superwindow. Then, it takes all the windows results to create a complete gene summary of the found windows. It also creates the random background of genes to be used as an internal comparison when we make the violin plots, makes individual plots for each neuronal type and number of motifs and creates plots that compare visually all selected neuronal types. Last, it creates .tsv files with the percentage of windows in each type, the composition of such windows, and a file for each number of motifs and neuronal type that contains the detailed information on every window.


If you encounter any trouble during usage of these scripts, please report it to esousa@ibv.csic.es.
